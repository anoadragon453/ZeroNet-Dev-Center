<!DOCTYPE html>
<html lang="en">
<head>
	<title>ZeroNet Dev Center</title>
	<meta charset="utf-8">
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="keywords" content="zite,zites,important,krixano,list,category,search,filter">
	<base href="" target="_top" id="base">
	<script>base.href = document.location.href.replace("/media", "").replace("index.html", "").replace(/[&?]wrapper=False/, "").replace(/[&?]wrapper_nonce=[A-Za-z0-9]+/, "")</script>

	<link rel="stylesheet" href="css/buefy.css" />
	<link rel="stylesheet" href="css/main.css" />

	<style>
	</style>

	<script src="js/navToggle.js" defer></script>
</head>
<body>
	<div id="app">
		<my-hero v-bind:class="{ 'is-medium': heroIsMedium }" title="ZeroNet Dev Center" subtitle="Tutorials, Questions, Collaboration">
			<a href="tutorials/?t=the_basics" class="button is-info">The Basics</a>
			<a href="tutorials/" style="margin-top: 10px; margin-left: 10px;">All Tutorials</a>
			<a onclick="is_click()">Test</a>
		</my-hero>

		<my-body></my-body>

		<my-footer></my-footer>
	</div>

	<script type="text/javascript" src="js/vue.min.js"></script>
	<script type="text/javascript" src="js/vueRoutes.js"></script>
	<script type="text/javascript" src="js/vueComponents.js"></script>

	<script type="text/javascript" src="js/buefy.js"></script>
	
	<script type="text/javascript" src="js/ZeroFrame.js"></script>

	<script>
		var urlParams;
		(window.onpopstate = function () {
		    var match,
		        pl     = /\+/g,  // Regex for replacing addition symbol with a space
		        search = /([^&=]+)=?([^&]*)/g,
		        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
		        query  = window.location.search.substring(1);

		    urlParams = {};
		    while (match = search.exec(query))
		       urlParams[decode(match[1])] = decode(match[2]);
		})();

		Vue.use(Buefy);

		var app = new Vue({
			el: '#app',
			data: {
				tutorialsList: "",
				heroIsMedium: true
			}
		});

		class ZeroChat extends ZeroFrame {
			onOpenWebsocket () {
				this.cmd("siteInfo", {}, (site_info) => {
					if (site_info.cert_user_id)
						document.getElementById("select_user").innerText = site_info.cert_user_id
					this.site_info = site_info
				});

				page.cmd('dbQuery', ['SELECT * FROM tutorials'], (tutorials) => {
					for (var i in tutorials) {
						app.tutorialsList += "<a href='tutorials/?t=" + tutorials[i].slug + "'>" + tutorials[i].title + "</a><br>";
					}
					//page.cmd('wrapperPushState', [{}, '', '']);
					app.tutorialsList += "Database Basics (Coming Soon)";
				});
			}

			selectUser () {
				this.cmd("certSelect", {accepted_domains: ["zeroid.bit", "kaffie.bit", "cryptoid.bit"]})
				return false
			}

			onRequest (cmd, message) {
				if (cmd == "setSiteInfo") {
					this.site_info = message.params  // Save site info data to allow access it later
					if (message.params.cert_user_id){
						document.getElementById("select_user").innerHTML = message.params.cert_user_id
					} else if (!message.params.cert_user_id) {
						document.getElementById("select_user").innerHTML = "Select user"
					} else if (message.params.event && message.params.event[0] == "file_done") {
						//this.loadZiteIndicator();
					}
				}
			}
		}

		page = new ZeroChat()

		function is_click() {
			app.heroIsMedium = false;
		}

		/*function getParameterByName(name, url) {
		    if (!url) url = window.location.href;
		    name = name.replace(/[\[\]]/g, "\\$&");
		    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
		        results = regex.exec(url);
		    if (!results) return null;
		    if (!results[2]) return '';
		    return decodeURIComponent(results[2].replace(/\+/g, " "));
		}*/
	</script>

	<!--<script>

	class Page extends ZeroFrame {
		setSiteInfo(site_info) {
			var out = document.getElementById("out")
			out.innerHTML =
				"Page address: " + site_info.address +
				"<br>- Peers: " + site_info.peers +
				"<br>- Size: " + site_info.settings.size +
				"<br>- Modified: " + (new Date(site_info.content.modified*1000))
		}

		onOpenWebsocket() {
			this.cmd("siteInfo", [], function(site_info) {
				page.setSiteInfo(site_info)
			})
		}

		onRequest(cmd, message) {
			if (cmd == "setSiteInfo")
				this.setSiteInfo(message.params)
			else
				this.log("Unknown incoming message:", cmd)
		}
	}
	page = new Page()

</script>-->

</body>
</html>